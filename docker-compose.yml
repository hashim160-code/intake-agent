services:
  intake-agent:
    build:
      context: .
      dockerfile: Dockerfile.agent
    command: ["python", "-m", "src.worker_service"]
    env_file:
      - .env
    ports:
      - "8080:8080"
    volumes:
      - ./transcripts:/app/transcripts
    restart: unless-stopped

  intake-api:
    build:
      context: .
      dockerfile: Dockerfile.agent
    command: ["python", "-m", "src.intake_api"]
    env_file:
      - .env
    ports:
      - "8001:8080"
    depends_on:
      - intake-agent
      - intake-data-api

  intake-data-api:
    build:
      context: .
      dockerfile: Dockerfile.agent
    command: ["python", "-m", "src.api_server"]
    env_file:
      - .env
    ports:
      - "4000:8080"
